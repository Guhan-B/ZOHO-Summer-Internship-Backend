generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model team {
  id            Int        @id @default(autoincrement())
  name          String     @db.VarChar(100)
  size          Int
  result        Int        @default(0)
  tournament_id Int
  tournament    tournament @relation(fields: [tournament_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_team_tournament")
  member        member[]

  @@index([tournament_id], map: "fk_team_tournament")
}

model tournament {
  id            Int      @id @default(autoincrement())
  name          String   @db.VarChar(100)
  sport         String   @db.VarChar(100)
  description   String   @db.VarChar(200)
  team_size     Int
  cancelled     Int      @default(0)
  event_date    String   @db.VarChar(100)
  deadline_date String   @db.VarChar(100)
  member        member[]
  team          team[]
}

model user {
  id            Int      @id @default(autoincrement())
  name          String   @db.VarChar(100)
  mobile_number String   @db.VarChar(20)
  blood_group   String   @db.VarChar(5)
  email         String   @unique(map: "email") @db.VarChar(100)
  password      String   @db.VarChar(256)
  role          Int      @default(0)
  member        member[]
}

model member {
  id            Int        @id @default(autoincrement())
  user_id       Int
  team_id       Int
  tournament_id Int
  type          Int
  team          team       @relation(fields: [team_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_member_team")
  tournament    tournament @relation(fields: [tournament_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_member_tournament")
  user          user       @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_member_user")

  @@unique([tournament_id, user_id], map: "uc_member")
  @@index([team_id], map: "fk_member_team")
  @@index([user_id], map: "fk_member_user")
}
